{% extends "base.html" %}

{% block content %}
<div class="flex-between mb-4">
    <h2>
        {% if readonly %}
        View Note
        {% else %}
        Create Encrypted Note
        {% endif %}
    </h2>
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Back</a>
</div>

<div class="card">
    {% if readonly %}
    <div class="form-group">
        <label>Decrypted Content</label>
        <div
            style="white-space: pre-wrap; font-family: 'JetBrains Mono', monospace; min-height: 200px; padding: 1rem; background: rgba(15, 23, 42, 0.5); border-radius: 8px; border: 1px solid var(--glass-border);">
            {{ content }}</div>
    </div>
    <div style="margin-top: 2rem; border-top: 1px solid var(--glass-border); padding-top: 1rem;">
        <div class="flex-between">
            <p style="color: var(--text-secondary); font-size: 0.9rem;">
                Note ID: <span style="font-family: monospace;">{{ note_id }}</span>
            </p>
            <a href="{{ url_for('edit_note', note_id=note_id) }}" class="btn">Edit Note</a>
        </div>
    </div>
    {% else %}
    <form method="POST">
        <div class="form-group">
            <label for="content">Note Content</label>
            <textarea id="content" name="content" required
                placeholder="Type your secret message here...">{{ content }}</textarea>
        </div>
        <div class="text-right">
            <button type="submit" class="btn">Encrypt & Save</button>
        </div>
    </form>
    <p style="margin-top: 1rem; color: var(--text-secondary); font-size: 0.85rem;">
        Note: Once saved, this note will be encrypted with your current session key.
        It can only be read by deriving the key from your Phrase + PIN.
    </p>
    {% endif %}
</div>
{% endblock %}